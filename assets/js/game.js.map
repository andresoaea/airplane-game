{"version":3,"sources":["webpack:///./src/js/Socket.js","webpack:///./src/js/components/Plane.js","webpack:///./src/js/components/Players.js","webpack:///./src/js/game.js","webpack:///./src/js/scenes/LoadScene.js","webpack:///./src/js/scenes/MainScene.js","webpack:///./src/js/scenes/SetPlaneScene.js","webpack:///./src/sass/game.scss?4097"],"names":["Socket","players","url","player","id","opponent","conn","WebSocket","onopen","e","console","log","msg","readyState","CLOSED","send","Plane","config","scene","x","y","planeNum","add","existing","setScale","setInteractive","setData","input","on","startDrag","planeName","stablePos","planeCells","isInDropZone","firstClickTime","pointer","targets","dragObj","checkDoubleTap","off","doDrag","stopDrag","pointerDiffY","pointerDiffX","initialPos","getData","game","width","dragX","dragY","dropZone","getDropZone","height","repositionToClosest","setPlaneCells","goToInitialPosition","tweens","scaleX","scaleY","duration","planes","axis","isVertical","angle","repositionVertical","repositionHorizontal","i","closest","relativeDistance","newPos","dropZoneRect","headCellId","planeData","getPlanePositionData","headPoint","cells","forEach","cell","rect","centerX","centerY","headCords","split","map","num","parseInt","schema","originX","diff","originY","length","line","j","cellPlaceholder","push","currPlaneExists","Object","keys","includes","instance","isOverlapping","checkOverlap","shift","firstPlaneCells","overlap","cellSize","getTime","elapsed","d","Date","Phaser","GameObjects","Sprite","Players","getParameterByName","name","photo","window","location","href","replace","regex","RegExp","results","exec","decodeURIComponent","axios","require","defaults","headers","common","type","AUTO","parent","title","version","Game","LoadScene","MainScene","SetPlaneScene","start","key","load","image","showPreloader","fontStyle","fontFamily","fontSize","color","stroke","strokeThickness","shadow","offsetX","offsetY","blur","fill","progressBar","graphics","progressBox","fillStyle","fillRect","cameras","main","loadingText","make","text","style","setOrigin","percentText","value","setText","clear","destroy","Scene","physics","arcade","data","planesCells","planesData","setBackgroundColor","cl","lineStyle","strokeRectShape","drawSceneBackground","socket","onmessage","JSON","parse","opponentDisconnected","restart","cellId","cellClicked","fillRectShape","drawPlayerMap","drawByCells","sqareWidth","cellsNum","drawRect","Geom","Rectangle","Contains","owner","stringify","drawBgRect","plane1","plane2","addStartGame","useHandCursor","allPlanesCells","keysLength","stop","squareWidth","drawBorder"],"mappings":"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","file":"/js/game.js","sourcesContent":["class Socket {\n    constructor(players) {\n        const url = `ws://192.168.0.105:8080/comm?playerId=${players.player.id}&opponentId=${players.opponent.id}`;\n        const conn = new WebSocket(url);\n        conn.onopen = function(e) {\n            console.log(`Connection established to ${url}`);\n        };\n        // conn.onmessage = (e) => {\n        //     console.log(e.data);\n        // };\n        this.conn = conn;\n    }\n\n    send(msg) {\n        if (this.conn.readyState === WebSocket.CLOSED) return;\n        return this.conn.send(msg);\n    }\n}\n\nexport default Socket;\n","class Plane extends Phaser.GameObjects.Sprite {\n    constructor(config) {\n        super(config.scene, config.x, config.y, `plane-${config.planeNum}`);\n        config.scene.add.existing(this);\n\n        this.scene = config.scene;\n\n        this.setScale(0.4)\n            .setInteractive()\n            .setData('initialPos', {\n                x: this.x,\n                y: this.y,\n            });\n\n        this.scene.input.on('pointerdown', this.startDrag, this);\n\n        // Other variables\n\n        this.planeName = `plane${config.planeNum}`;\n        this.stablePos = [\n            {\n                x: this.x,\n                y: this.y,\n            },\n        ];\n        this.planeCells = [];\n        this.isInDropZone = false;\n        this.firstClickTime = 0;\n        // this.lastPos = { x: 0, y: 0 };\n        // this.lastAngle = 0;\n    }\n\n    startDrag(pointer, targets) {\n        if (targets[0] !== this) return;\n        this.dragObj = targets[0];\n\n        // this.dragObj.depth++;\n        // this.scene.planes.map((plane) => {\n        //     return plane.instance.depth--;\n        // });\n\n        // if (this.scene.planes.length === 2) {\n        //     this.scene.planes.find((plane) => {\n        //         return plane.instance === this;\n        //     });\n        // }\n\n        //  console.log(this.dragObj.depth);\n        // console.log(this.planeName);\n\n        this.checkDoubleTap();\n        this.scene.input.off('pointerdown', this.startDrag, this);\n        this.scene.input.on('pointermove', this.doDrag, this);\n        this.scene.input.on('pointerup', this.stopDrag, this);\n\n        if (typeof this.dragObj !== 'undefined') {\n            this.pointerDiffY = pointer.y - this.dragObj.y;\n            this.pointerDiffX = pointer.x - this.dragObj.x;\n        }\n    }\n\n    doDrag(pointer, targets) {\n        if (targets[0] !== this) return;\n\n        if (typeof this.dragObj !== 'undefined') {\n            // Move\n            this.dragObj.x = pointer.x - this.pointerDiffX;\n            this.dragObj.y = pointer.y - this.pointerDiffY;\n\n            let initialPos = this.dragObj.getData('initialPos');\n\n            // Scale\n            if (pointer.x < initialPos.x) {\n                if (this.isInDropZone) {\n                    this.dragObj.setScale(1.1);\n                } else {\n                    this.dragObj.setScale(\n                        (game.config.width - this.dragObj.x) / 450\n                    );\n                }\n            }\n        }\n    }\n\n    stopDrag(pointer, targets) {\n        if (targets[0] !== this) return;\n\n        this.scene.input.on('pointerdown', this.startDrag, this);\n        this.scene.input.off('pointermove', this.doDrag, this);\n        this.scene.input.off('pointerup', this.stopDrag, this);\n\n        if (typeof this.dragObj == 'undefined') return;\n\n        // Check if in drop zone\n        let dragX = this.dragObj.x;\n        let dragY = this.dragObj.y;\n\n        let dropZone = this.getDropZone();\n\n        if (\n            dragX > dropZone.x &&\n            dragX < dropZone.x + dropZone.width &&\n            dragY > dropZone.y &&\n            dragY < dropZone.y + dropZone.height\n        ) {\n            // Inside drop zone\n            this.dragObj.setScale(1);\n\n            //console.log(this.lastAngle);\n\n            // if (\n            //     (this.x !== this.lastPos.x && this.y !== this.lastPos.y) ||\n            //     this.angle !== this.lastAngle\n            // ) {\n            this.repositionToClosest('x');\n            this.repositionToClosest('y');\n            // }\n\n            // this.lastPos = {\n            //     x: this.x,\n            //     y: this.y,\n            // };\n            // this.lastAngle = this.angle;\n\n            this.setPlaneCells();\n\n            this.isInDropZone = true;\n\n            //this.dragObj.x =\n        } else {\n            // Outside drop zone / Go back to initial position\n            this.goToInitialPosition();\n\n            this.isInDropZone = false;\n        }\n    }\n\n    goToInitialPosition() {\n        this.scene.tweens.add({\n            targets: [this.dragObj],\n            x: this.dragObj.getData('initialPos').x,\n            y: this.dragObj.getData('initialPos').y,\n            scaleX: 0.4,\n            scaleY: 0.4,\n            duration: 500,\n        });\n\n        // console.log(this.scene.planes);\n        delete this.scene.planes[this.planeName];\n        // console.log(this.scene.planes);\n    }\n\n    repositionToClosest(axis) {\n        let isVertical = this.angle === 90 || this.angle === -90;\n\n        if (isVertical) {\n            this.repositionVertical(axis);\n        } else {\n            this.repositionHorizontal(axis);\n        }\n\n        // console.log(isVertical);\n    }\n\n    repositionHorizontal(axis) {\n        let dropZone = this.getDropZone();\n\n        for (let i = 0; i < 8; i++) {\n            if (i < 2) continue;\n\n            let closest = i * 40;\n            let relativeDistance = this.dragObj[axis] - dropZone[axis];\n\n            if (axis === 'y') {\n                relativeDistance = relativeDistance + 20;\n            }\n\n            if (relativeDistance - closest < 39) {\n                // Horizontal plane\n                let newPos = closest + dropZone[axis] + (axis === 'x' ? 20 : 0);\n\n                if (i > 5) {\n                    // this.dragObj[axis] =\n                    //     5 * 40 + dropZone[axis] + (axis === 'x' ? 20 : 0);\n                    if (axis === 'x') {\n                        this.dragObj.x = 5 * 40 + dropZone.x + 20;\n                    } else {\n                        this.dragObj.y = 5 * 40 + dropZone.x;\n                    }\n                } else {\n                    this.dragObj[axis] = newPos;\n                }\n\n                break;\n            }\n        }\n    }\n\n    repositionVertical(axis) {\n        let dropZone = this.getDropZone();\n\n        for (let i = 0; i < 9; i++) {\n            if (i < 2) continue;\n\n            let closest = i * 40;\n            let relativeDistance = this.dragObj[axis] - dropZone[axis];\n\n            if (axis === 'x') {\n                relativeDistance = relativeDistance + 20;\n            }\n\n            if (relativeDistance - closest < 39) {\n                // Horizontal plane\n                let newPos = closest + dropZone[axis] + (axis === 'y' ? 20 : 0);\n\n                if (i > 5) {\n                    // this.dragObj[axis] =\n                    //     5 * 40 + dropZone[axis] + (axis === 'x' ? 20 : 0);\n                    if (axis === 'x') {\n                        this.dragObj.x = 6 * 40 + dropZone.x;\n                        //console.log('aici 1');\n                    } else {\n                        this.dragObj.y = 5 * 40 + dropZone.x - 20;\n                        ///console.log('aici 2');\n                    }\n                } else {\n                    this.dragObj[axis] = newPos;\n                }\n\n                break;\n            }\n        }\n    }\n\n    getDropZone() {\n        let { x, y, width, height } = this.scene.dropZoneRect;\n        return { x, y, width, height };\n    }\n\n    setPlaneCells() {\n        let headCellId;\n        let planeData = this.getPlanePositionData();\n        let headPoint = planeData.headPoint;\n\n        //console.log(planeData);\n\n        this.scene.cells.forEach((cell) => {\n            if (\n                cell.rect.centerX === headPoint.x &&\n                cell.rect.centerY === headPoint.y\n            ) {\n                headCellId = cell.id;\n            }\n        });\n\n        //console.log(headCellId);\n\n        let headCords = headCellId.split('').map((num) => parseInt(num));\n        headCords = { x: headCords[0], y: headCords[1] };\n\n        // let planeCells = [\n        //     headCellId,\n        //     // `${headCords.y + 1}${headCords.x - 2}`,\n        //     // `${headCords.y + 1}${headCords.x - 1}`,\n        //     // `${headCords.x}${headCords.y + 1}`,\n        //     // `${headCords.x + 1}${headCords.y + 1}`,\n        //     // `${headCords.x + 2}${headCords.y + 1}`,\n        //     // `${headCords.x}${headCords.y + 2}`,\n        //     // `${headCords.y + 3}${headCords.x - 1}`,\n        //     // `${headCords.x}${headCords.y + 3}`,\n        //     // `${headCords.x + 1}${headCords.y + 3}`,\n        // ];\n        let planeCells = [];\n\n        let schema = planeData.schema;\n\n        let originX = headCords.x + planeData.diff.x;\n        let originY = headCords.y + planeData.diff.y;\n\n        for (let i = 0; i < schema.length; i++) {\n            const line = schema[i];\n            //console.log('line', i);\n\n            for (let j = 0; j < line.length; j++) {\n                const cellPlaceholder = line[j];\n\n                if (cellPlaceholder) {\n                    planeCells.push(`${originX + j}${originY + i}`);\n                }\n\n                //console.log(`${i + 1}${j + 1}`);\n            }\n        }\n\n        //console.log(planeCells);\n        this.planeCells = planeCells;\n\n        if (this.scene.planes[this.planeName]) {\n            this.scene.planes[this.planeName].cells = planeCells;\n        }\n\n        // Push current plane to planes object\n\n        const currPlaneExists = Object.keys(this.scene.planes).includes(\n            this.planeName\n        );\n\n        if (!currPlaneExists) {\n            this.scene.planes[this.planeName] = {\n                cells: planeCells,\n                instance: this,\n            };\n        }\n\n        // let existingCurrentPlane = this.scene.planes.find((plane) => {\n        //     return plane.name === this.planeName;\n        // });\n\n        // if (!existingCurrentPlane) {\n        //     this.scene.planes.push({\n        //         name: this.planeName,\n        //         cells: planeCells,\n        //         instance: this,\n        //     });\n        // }\n\n        // Check for overlap\n        let isOverlapping = this.checkOverlap();\n        console.log(isOverlapping);\n        if (!isOverlapping) {\n            this.stablePos.push({\n                x: this.x,\n                y: this.y,\n            });\n\n            if (this.stablePos.length > 1) {\n                this.stablePos.shift();\n            }\n        }\n\n        //localStorage.setItem('lastPlaceCells', planeCells.join(','));\n    }\n\n    checkOverlap() {\n        let keys = Object.keys(this.scene.planes);\n        if (keys.length < 2) return false;\n\n        let firstPlaneCells = this.scene.planes[keys[0]].cells;\n        // console.log(firstPlaneCells);\n        let overlap = false;\n\n        for (let i = 0; i < this.planeCells.length; i++) {\n            if (firstPlaneCells.includes(this.planeCells[i])) {\n                //console.log('overlap');\n\n                // Reposition plane back to last stable positio\n                if (\n                    this.stablePos[0].x === this.getData('initialPos').x &&\n                    this.stablePos[0].y === this.getData('initialPos').y\n                ) {\n                    this.goToInitialPosition();\n\n                    //console.log('overl init');\n                } else {\n                    this.x = this.stablePos[0].x;\n                    this.y = this.stablePos[0].y;\n                    // console.log('overl afetr');\n                }\n\n                console.log(this.planeCells[i]);\n\n                overlap = true;\n                break;\n            }\n        }\n\n        return overlap;\n    }\n\n    getPlanePositionData() {\n        let schema;\n        let headPoint;\n        let diff; // Compute start point difference\n        // It is distance in cells from plane head\n        // to plane margin (top/left 0)\n\n        switch (this.angle) {\n            case 90:\n                headPoint = {\n                    x: this.x + this.height / 2 - this.scene.cellSize / 2,\n                    y: this.y,\n                };\n                schema = [\n                    [0, 0, 1, 0],\n                    [1, 0, 1, 0],\n                    [1, 1, 1, 1],\n                    [1, 0, 1, 0],\n                    [0, 0, 1, 0],\n                ];\n                diff = {\n                    x: -3,\n                    y: -2,\n                };\n                break;\n            case -180:\n                headPoint = {\n                    x: this.x,\n                    y: this.y + this.height / 2 - this.scene.cellSize / 2,\n                };\n                schema = [\n                    [0, 1, 1, 1, 0],\n                    [0, 0, 1, 0, 0],\n                    [1, 1, 1, 1, 1],\n                    [0, 0, 1, 0, 0],\n                ];\n                diff = {\n                    x: -2,\n                    y: -3,\n                };\n                break;\n            case -90:\n                headPoint = {\n                    x: this.x - this.height / 2 + this.scene.cellSize / 2,\n                    y: this.y,\n                };\n                schema = [\n                    [0, 1, 0, 0],\n                    [0, 1, 0, 1],\n                    [1, 1, 1, 1],\n                    [0, 1, 0, 1],\n                    [0, 1, 0, 0],\n                ];\n                diff = {\n                    x: 0,\n                    y: -2,\n                };\n                break;\n\n            default:\n                headPoint = {\n                    x: this.x,\n                    y: this.y - this.height / 2 + this.scene.cellSize / 2,\n                };\n                schema = [\n                    [0, 0, 1, 0, 0],\n                    [1, 1, 1, 1, 1],\n                    [0, 0, 1, 0, 0],\n                    [0, 1, 1, 1, 0],\n                ];\n                diff = {\n                    x: -2,\n                    y: 0,\n                };\n        }\n\n        return { schema, headPoint, diff };\n    }\n\n    checkDoubleTap() {\n        if (typeof this.dragObj === 'undefined') return;\n\n        if (this.firstClickTime == 0) {\n            this.firstClickTime = this.getTime();\n            return;\n        }\n\n        let elapsed = this.getTime() - this.firstClickTime;\n\n        if (elapsed < 400) {\n            // Rotate plane on double tap\n\n            this.angle += 90;\n            // this.repositionToClosest('x');\n            // this.repositionToClosest('y');\n        }\n\n        this.firstClickTime = 0;\n    }\n\n    getTime() {\n        //make a new date object\n        let d = new Date();\n        //return the number of milliseconds since 1 January 1970 00:00:00.\n        return d.getTime();\n    }\n}\n\nexport default Plane;\n","class Players {\n    constructor() {\n        this.player = {\n            id: this.getParameterByName('userId') ?? '1',\n            name: 'User',\n            photo: null,\n        };\n\n        this.opponent = {\n            id: this.getParameterByName('opponentId') ?? '2',\n            name: 'UserOpponent',\n            photo: null,\n        };\n    }\n\n    // helper for debugging\n    getParameterByName(name, url = window.location.href) {\n        name = name.replace(/[\\[\\]]/g, '\\\\$&');\n        var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),\n            results = regex.exec(url);\n        if (!results) return null;\n        if (!results[2]) return '';\n        return decodeURIComponent(results[2].replace(/\\+/g, ' '));\n    }\n}\n\nexport default Players;\n","import Phaser from 'phaser';\n// import moment, { lang } from 'moment';\n// import Swal from 'sweetalert2';\n\n// window.moment = moment;\n// window.Swal = Swal;\n\n// //indow.jQuery = window.$ = require('jquery');\nwindow.axios = require('axios');\nwindow.axios.defaults.headers.common['X-Requested-With'] = 'XMLHttpRequest';\n\nimport LoadScene from './scenes/LoadScene';\nimport MainScene from './scenes/MainScene';\nimport SetPlaneScene from './scenes/SetPlaneScene';\n\nlet config = {\n    type: Phaser.AUTO,\n    width: 800,\n    height: 458,\n    parent: 'game',\n    // physics: {\n    //     default: 'arcade',\n    //     arcade: {\n    //         gravity: { y: 800 },\n    //         //debug: true\n    //     },\n    // },\n    title: 'The Airplanes with Friends',\n    url: '',\n    version: '1.0.0',\n};\n\nlet game = new Phaser.Game(config);\ngame.scene.add('LoadScene', new LoadScene());\ngame.scene.add('MainScene', new MainScene());\ngame.scene.add('SetPlaneScene', new SetPlaneScene());\ngame.scene.start('LoadScene');\nwindow.game = game;\n","class LoadScene extends Phaser.Scene {\n    constructor() {\n        super({\n            key: 'LoadScene',\n        });\n    }\n\n    preload() {\n        /**\n         * LoadScene images\n         */\n\n        // this.load.multiatlas(\n        //     'atlas',\n        //     'assets/sprites/tp/atlas.json',\n        //     'assets/sprites/tp'\n        // );\n\n        this.load.image('btn-start-game', 'assets/images/btn-start-game.png');\n        this.load.image('plane-1', 'assets/images/planes/plane-1.png');\n        this.load.image('plane-2', 'assets/images/planes/plane-2.png');\n\n        this.showPreloader();\n    }\n\n    showPreloader() {\n        let scene = this;\n\n        let fontStyle = {\n            fontFamily: 'Play',\n            fontSize: 28,\n            color: '#ffffff',\n            stroke: '#fff',\n            strokeThickness: 2,\n            shadow: {\n                offsetX: 1,\n                offsetY: 1,\n                color: '#000',\n                blur: 0,\n                stroke: true,\n                fill: true,\n            },\n        };\n\n        let progressBar = scene.add.graphics();\n        let progressBox = scene.add.graphics();\n        progressBox.fillStyle(0x222222, 0.05);\n        progressBox.fillRect(\n            (game.config.width - 250) / 2,\n            game.config.height / 2 + 40,\n            250,\n            50\n        );\n\n        let width = scene.cameras.main.width;\n        let height = scene.cameras.main.height;\n        let loadingText = scene.make.text({\n            x: width / 2,\n            y: height / 2 - 50,\n            text: 'Loading...',\n            style: fontStyle,\n        });\n        loadingText.setOrigin(0.5, 0.5);\n\n        let percentText = scene.make.text({\n            x: width / 2,\n            y: height / 2 - 5,\n            text: '0%',\n            style: fontStyle,\n        });\n        percentText.setOrigin(0.5, 0.5);\n\n        scene.load.on('progress', function(value) {\n            percentText.setText(parseInt(value * 100) + '%');\n            progressBar.clear();\n            progressBar.fillStyle(0xbf4689, 1);\n            progressBar.fillRect(\n                (game.config.width - 250) / 2 + 5,\n                game.config.height / 2 + 50,\n                240 * value,\n                30\n            );\n        });\n\n        scene.load.on('complete', function() {\n            // console.log('preload done')\n\n            progressBar.destroy();\n            progressBox.destroy();\n            loadingText.destroy();\n            percentText.destroy();\n\n            //game.scene.start('Start');\n\n            game.scene.start('SetPlaneScene');\n        });\n    }\n}\n\nexport default LoadScene;\n","import Socket from '../Socket';\nimport Players from '../components/Players';\n\nclass MainScene extends Phaser.Scene {\n    constructor() {\n        super({\n            key: 'MainScene',\n            physics: {\n                arcade: {\n                    //debug: true,\n                },\n            },\n        });\n\n        this.cells = {};\n    }\n\n    init(data) {\n        this.planesCells = data.planesData.cells;\n        this.cameras.main.setBackgroundColor('#fff');\n    }\n\n    //debug\n    drawByCells(cells) {\n        console.log(this.cells);\n\n        cells.forEach((cl) => {\n            //   let graphics = this.add.graphics({ fillStyle: { color: 0x0000ff } });\n            var graphics = this.add.graphics({\n                lineStyle: { width: 3, color: 0x000000 },\n            });\n            graphics.strokeRectShape(this.cells[`o${cl}`].rect);\n        });\n    }\n\n    create() {\n        this.drawSceneBackground();\n\n        // Setup players\n        this.players = new Players();\n\n        this.socket = new Socket(this.players);\n\n        this.socket.conn.onmessage = (e) => {\n            console.log(e.data);\n            const msg = JSON.parse(e.data);\n\n            if (msg.opponentDisconnected) {\n                console.log('opponent disconnected');\n                this.scene.restart();\n            }\n\n            const cellId = msg.cellClicked;\n            if (!cellId) return;\n\n            const graphics = this.add.graphics({\n                fillStyle: { color: 0x0000ff },\n            });\n\n            graphics.fillRectShape(this.cells[cellId.replace('p', 'o')].rect);\n        };\n\n        const x = 40;\n        const y = 80;\n\n        this.drawPlayerMap(x, y);\n        this.drawPlayerMap(440, y, 'opponent');\n\n        //debug\n        window.Socket = Socket;\n        window.MainScene = this;\n        this.drawByCells(this.planesCells);\n    }\n\n    drawPlayerMap(x, y, type = null) {\n        const sqareWidth = 40;\n        const cellsNum = 8;\n\n        for (let i = 0; i < cellsNum; i++) {\n            // Go vertical\n            for (let j = 0; j < cellsNum; j++) {\n                // Go horizontal\n                this.drawRect(\n                    x + j * sqareWidth,\n                    y + i * sqareWidth,\n                    sqareWidth,\n                    i,\n                    j,\n                    type\n                );\n            }\n        }\n    }\n\n    drawRect(x, y, sqareWidth, i, j, type) {\n        let rect = new Phaser.Geom.Rectangle(x, y, sqareWidth, sqareWidth);\n        //   let graphics = this.add.graphics({ fillStyle: { color: 0x0000ff } });\n        var graphics = this.add.graphics({\n            lineStyle: { width: 1, color: 0x0000aa },\n        });\n        graphics.strokeRectShape(rect);\n\n        graphics.setInteractive(\n            new Phaser.Geom.Rectangle(x, y, sqareWidth, sqareWidth),\n            Phaser.Geom.Rectangle.Contains\n        );\n\n        const owner = type === 'opponent' ? 'p' : 'o';\n\n        const id = `${owner}${j + 1}${i + 1}`;\n        this.cells[id] = { graphics, rect };\n        // graphics.setData('id', id);\n        graphics.on('pointerdown', () => {\n            if (type !== 'opponent') return;\n\n            this.socket.send(\n                JSON.stringify({\n                    cellClicked: id,\n                })\n            );\n\n            // console.log(graphics.getData('id'));\n            graphics = this.add.graphics({\n                fillStyle: { color: 0x0000ff },\n            });\n\n            graphics.fillRectShape(rect);\n        });\n    }\n\n    drawSceneBackground() {\n        const x = 0;\n        const y = 0;\n        const sqareWidth = 40;\n        const cellsNum = 20;\n\n        for (let i = 0; i < cellsNum; i++) {\n            // Go vertical\n            for (let j = 0; j < cellsNum; j++) {\n                // Go horizontal\n                this.drawBgRect(\n                    x + j * sqareWidth,\n                    y + i * sqareWidth,\n                    sqareWidth,\n                    i,\n                    j\n                );\n            }\n        }\n    }\n\n    drawBgRect(x, y, sqareWidth, i, j) {\n        let rect = new Phaser.Geom.Rectangle(x, y, sqareWidth, sqareWidth);\n        //   let graphics = this.add.graphics({ fillStyle: { color: 0x0000ff } });\n        var graphics = this.add.graphics({\n            lineStyle: { width: 1, color: 0xeeeeee },\n        });\n        graphics.strokeRectShape(rect);\n    }\n}\n\nexport default MainScene;\n","import Players from '../components/Players';\nimport Plane from '../components/Plane';\n\nclass SetPlaneScene extends Phaser.Scene {\n    constructor() {\n        super({\n            key: 'SetPlaneScene',\n            physics: {\n                arcade: {\n                    //debug: true,\n                },\n            },\n        });\n\n        this.cellSize = 40;\n        this.cells = [];\n\n        this.planes = {};\n    }\n\n    init() {\n        this.cameras.main.setBackgroundColor('#fff');\n    }\n\n    create() {\n        this.drawSceneBackground();\n\n        // Setup players\n        this.players = new Players();\n\n        // this.socket = new Socket(this.players);\n\n        const x = 120;\n        const y = 80;\n\n        this.drawPlayerMap(x, y);\n\n        //this.plane = new Plane(this);\n        let plane1 = new Plane({\n            scene: this,\n            x: game.config.width / 2 + 200,\n            y: 140,\n            planeNum: 1,\n        });\n\n        let plane2 = new Plane({\n            scene: this,\n            x: game.config.width / 2 + 300,\n            y: 140,\n            planeNum: 2,\n        });\n\n        // Start game btn\n        this.addStartGame();\n\n        //debug\n        // window.Socket = Socket;\n        window.SetPlaneScene = this;\n\n        // let cls = localStorage.getItem('lastPlaceCells').split(',');\n        // this.drawByCells(cls);\n    }\n\n    addStartGame() {\n        this.add\n            .image(630, 380, 'btn-start-game')\n            .setInteractive({ useHandCursor: true })\n            .on('pointerup', () => {\n                let allPlanesCells = [];\n\n                let keys = Object.keys(this.planes);\n                let keysLength = keys.length;\n\n                if (keysLength < 2) {\n                    // add 2 planes\n                    return;\n                }\n\n                for (let i = 0; i < keysLength; i++) {\n                    allPlanesCells = [\n                        ...allPlanesCells,\n                        ...this.planes[keys[i]].cells,\n                    ];\n                }\n\n                this.scene.stop();\n                this.scene.start('MainScene', {\n                    planesData: {\n                        cells: allPlanesCells,\n                    },\n                });\n            });\n    }\n\n    // debug\n    drawByCells(cells) {\n        cells.forEach((cl) => {\n            //   let graphics = this.add.graphics({ fillStyle: { color: 0x0000ff } });\n            var graphics = this.add.graphics({\n                lineStyle: { width: 3, color: 0x000000 },\n            });\n            graphics.strokeRectShape(this.cells[cl].rect);\n        });\n    }\n\n    drawPlayerMap(x, y) {\n        const squareWidth = this.cellSize;\n        const cellsNum = 8;\n\n        for (let i = 0; i < cellsNum; i++) {\n            // Go vertical\n            for (let j = 0; j < cellsNum; j++) {\n                // Go horizontal\n                this.drawRect(\n                    x + j * squareWidth,\n                    y + i * squareWidth,\n                    squareWidth,\n                    i,\n                    j\n                );\n            }\n        }\n\n        this.drawBorder(x, y, squareWidth, cellsNum);\n    }\n\n    drawBorder(x, y, squareWidth, cellsNum) {\n        let width = squareWidth * cellsNum;\n        let rect = new Phaser.Geom.Rectangle(x, y, width, width);\n        //   let graphics = this.add.graphics({ fillStyle: { color: 0x0000ff } });\n        let graphics = this.add.graphics({\n            lineStyle: { width: 3, color: 0x000000 },\n        });\n        graphics.strokeRectShape(rect);\n\n        this.dropZoneRect = rect;\n    }\n\n    drawRect(x, y, squareWidth, i, j, type) {\n        let rect = new Phaser.Geom.Rectangle(x, y, squareWidth, squareWidth);\n        //   let graphics = this.add.graphics({ fillStyle: { color: 0x0000ff } });\n        let graphics = this.add.graphics({\n            lineStyle: { width: 1, color: 0x000000 },\n        });\n        graphics.strokeRectShape(rect);\n\n        const id = `${j + 1}${i + 1}`;\n\n        this.cells[id] = { id, rect };\n    }\n\n    drawSceneBackground() {\n        const x = 0;\n        const y = 0;\n        const squareWidth = this.cellSize;\n        const cellsNum = 20;\n\n        for (let i = 0; i < cellsNum; i++) {\n            // Go vertical\n            for (let j = 0; j < cellsNum; j++) {\n                // Go horizontal\n                this.drawBgRect(\n                    x + j * squareWidth,\n                    y + i * squareWidth,\n                    squareWidth,\n                    i,\n                    j\n                );\n            }\n        }\n    }\n\n    drawBgRect(x, y, squareWidth, i, j) {\n        let rect = new Phaser.Geom.Rectangle(x, y, squareWidth, squareWidth);\n        //   let graphics = this.add.graphics({ fillStyle: { color: 0x0000ff } });\n        var graphics = this.add.graphics({\n            lineStyle: { width: 1, color: 0xeeeeee },\n        });\n        graphics.strokeRectShape(rect);\n    }\n}\n\nexport default SetPlaneScene;\n","// removed by extract-text-webpack-plugin"],"sourceRoot":""}